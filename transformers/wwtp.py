# Transform WWTP fasta headers to fastq dito
# Fredrik Boulund 2016

def transform_fasta_header(fastaheader):
    """
    Do some string operations on FASTA headers to make them look like FASTQ
    headers.

    FASTA headers look like:
      >102B_1_HISEQ_138_D2DGEACXX_6_1101_6736_39162_1_N_0_ATTACTCGTAATCTTA 
    FASTQ headers look like:
      @HISEQ:138:D2DGEACXX:7:1101:1231:2207 2:N:0:TCCGGAGAGTACTGAC
    FASTQ filenames look like:
      8_130829_BD2DGEACXX_P477_235B_dual32_1_val_1.fq
    """
    fastq_source, read = fastaheader.split(" ", 1)[0].split("_HISEQ")
    read_header = read.split("_")
    read_header = "HISEQ:"+":".join(read_header[1:6])+" "+":".join(read_header[6:])
    fastq_base = fastq_source.rsplit("_", 1)[0]
    return fastq_base, read_header

def fastq_filename(fastq_base):
    """
    Return a pair of complete fastq filenames for fastq_base.
    """
    return fastq_filenames[fastq_base]+"_1_val_1.fq", fastq_filenames[fastq_base]+"_2_val_2.fq",


fastq_filenames = {
"103":  "1_130829_BD2DGEACXX_P477_103_dual3", 
"104":  "1_130829_BD2DGEACXX_P477_104_dual4", 
"112":  "1_130829_BD2DGEACXX_P477_112_dual12", 
"129B": "1_130829_BD2DGEACXX_P477_129B_dual29", 
"137B": "1_130829_BD2DGEACXX_P477_137B_dual37", 
"146":  "1_131008_AC2G2AACXX_P477_146_index5", 
"147":  "1_131008_AC2G2AACXX_P477_147_index7", 
"148":  "1_131008_AC2G2AACXX_P477_148_index8", 
"149":  "1_131008_AC2G2AACXX_P477_149_index9", 
"150":  "1_131008_AC2G2AACXX_P477_150_index10", 
"105":  "2_130829_BD2DGEACXX_P477_105_dual5", 
"106":  "2_130829_BD2DGEACXX_P477_106_dual6", 
"113":  "2_130829_BD2DGEACXX_P477_113_dual13", 
"114":  "2_130829_BD2DGEACXX_P477_114_dual14", 
"121":  "2_130829_BD2DGEACXX_P477_121_dual21", 
"151":  "2_131008_AC2G2AACXX_P477_151_index11", 
"152":  "2_131008_AC2G2AACXX_P477_152_index12", 
"153":  "2_131008_AC2G2AACXX_P477_153_index13", 
"154":  "2_131008_AC2G2AACXX_P477_154_index14", 
"155":  "2_131008_AC2G2AACXX_P477_155_index15", 
"107":  "3_130829_BD2DGEACXX_P477_107_dual7", 
"108":  "3_130829_BD2DGEACXX_P477_108_dual8", 
"115":  "3_130829_BD2DGEACXX_P477_115_dual15", 
"123":  "3_130829_BD2DGEACXX_P477_123_dual23", 
"216":  "3_130829_BD2DGEACXX_P477_216_dual16", 
"156":  "3_131008_AC2G2AACXX_P477_156_index16", 
"157":  "3_131008_AC2G2AACXX_P477_157_index17", 
"158":  "3_131008_AC2G2AACXX_P477_158_index18", 
"159":  "3_131008_AC2G2AACXX_P477_159_index19", 
"160":  "3_131008_AC2G2AACXX_P477_160_index20", 
"122":  "4_130829_BD2DGEACXX_P477_122_dual22", 
"130":  "4_130829_BD2DGEACXX_P477_130_dual30", 
"138":  "4_130829_BD2DGEACXX_P477_138_dual38", 
"228":  "4_130829_BD2DGEACXX_P477_228_dual28", 
"236":  "4_130829_BD2DGEACXX_P477_236_dual36", 
"161":  "4_131008_AC2G2AACXX_P477_161_index21", 
"162":  "4_131008_AC2G2AACXX_P477_162_index22", 
"163":  "4_131008_AC2G2AACXX_P477_163_index23", 
"164":  "4_131008_AC2G2AACXX_P477_164_index24", 
"165":  "4_131008_AC2G2AACXX_P477_165_index1", 
"124":  "5_130829_BD2DGEACXX_P477_124_dual24", 
"131":  "5_130829_BD2DGEACXX_P477_131_dual31", 
"139":  "5_130829_BD2DGEACXX_P477_139_dual39", 
"140":  "5_130829_BD2DGEACXX_P477_140_dual40", 
"232F": "5_130829_BD2DGEACXX_P477_232F_dual32", 
"166":  "5_131008_AC2G2AACXX_P477_166_index2", 
"167":  "5_131008_AC2G2AACXX_P477_167_index3", 
"168":  "5_131008_AC2G2AACXX_P477_168_index4", 
"169":  "5_131008_AC2G2AACXX_P477_169_index5", 
"170":  "5_131008_AC2G2AACXX_P477_170_index6", 
"102B": "6_130829_BD2DGEACXX_P477_102B_dual6", 
"111B": "6_130829_BD2DGEACXX_P477_111B_dual13", 
"117FB": "6_130829_BD2DGEACXX_P477_117FB_dual14", 
"201B": "6_130829_BD2DGEACXX_P477_201B_dual5", 
"220B": "6_130829_BD2DGEACXX_P477_220B_dual21", 
"109B": "7_130829_BD2DGEACXX_P477_109B_dual7", 
"110B": "7_130829_BD2DGEACXX_P477_110B_dual8", 
"118FB": "7_130829_BD2DGEACXX_P477_118FB_dual15", 
"119FB": "7_130829_BD2DGEACXX_P477_119FB_dual16", 
"226B": "7_130829_BD2DGEACXX_P477_226B_dual23", 
"225B": "8_130829_BD2DGEACXX_P477_225B_dual22", 
"227B": "8_130829_BD2DGEACXX_P477_227B_dual24", 
"233B": "8_130829_BD2DGEACXX_P477_233B_dual30", 
"234B": "8_130829_BD2DGEACXX_P477_234B_dual31", 
"235B": "8_130829_BD2DGEACXX_P477_235B_dual32", 
"141":  "8_131002_BC2G8KACXX_P477_141_index1", 
"142":  "8_131002_BC2G8KACXX_P477_142_index2", 
"143":  "8_131002_BC2G8KACXX_P477_143_index3", 
"144":  "8_131002_BC2G8KACXX_P477_144_index4", 
"145":  "8_131002_BC2G8KACXX_P477_145_index5", 
}
